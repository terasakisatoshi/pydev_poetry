version: '2.3'
services:
  python:
    build: ./
    container_name: pydev-poetry-jupyter
    volumes:
      - ./:/workspaces
      - ~/dataset:/dataset
  
  jupyter:
    build: ./
    container_name: pydev-poetry-jupyter
    volumes:
      - ./:/workspaces
      - ~/dataset:/dataset
    ports:
      - "8888:8888"
    command: /bin/bash -c "poetry install && poetry run jupyter notebook --notebook-dir /workspaces --ip=0.0.0.0 --allow-root"

  lab:
    build: ./
    container_name: pydev-poetry-lab
    volumes:
      - ./:/workspaces
      - ~/dataset:/dataset
    ports:
      - "8888:8888"
    command: /bin/bash -c "poetry install && poetry run jupyter lab --notebook-dir /workspaces --ip=0.0.0.0 --allow-root"

  lab-gpu:
    build: ./
    shm_size: '2gb'
    container_name: pydev-poetry-lab-gpu
    runtime: nvidia
    volumes:
      - ./:/workspaces
    ports:
      - "8889:8889"
    command: jupyter lab --notebook-dir /workspaces --port 8889 --ip=0.0.0.0

